---
title: "在2021年用电话线拨号上网管理服务器"
date: 2021-01-29
layout: post
---

# 电话线供电

没有电话交换机。直接用电话线把两个MODEM接起来(Dry line)是不工作的。

据说电话线上的电压:

 - 没有电话呼入呼出 20V
 - 有电话呼入 48V @50Hz左右
 - 接听状态 10V

电话交换机的作用是，制造一个48V 50Hz的信号，让MODEM振铃。MODEM会在串口上打出`RING`字样。

参考[这个](http://www.tldp.org/HOWTO/Modem-HOWTO-26.html)和[这个](https://www.jagshouse.com/modem.html)

```
		     +  | | -
 GREEN----------+---||||---/\/\/--+-------------RED
    	    |   | |     R     |
    	    |  9 to 24V       |
    	    |                 |
    	    +---||------------+
    		C .47uF

 RED-----------------------------------------------GREEN

```

手边刚好翻出一个9V电池。用两个曲别针当电极。

并把家里墙上的电话插座拆了。搭出了下面的东西:

![modem]({{ site.imageurl }}/modem.jpg)

# 直接通信

客户端:

```bash
picocom -b 115200 /dev/tty.usbmodem2

ATX0  #忽略拨号音
ATDT123123
```

(服务器)局端:

```bash
picocom -b 115200 /dev/ttyACM0

ATA
```

然后两只🐱就会协商，提示

```
CONNECT 115200
```

然后链路就通了，继续在picocom里打字，对端就会显示


# 进一步: getty

在服务器(局端)按`C-a C-q`退出picocom


```
systemctl start getty@ttyACM0.service
```

这时，在客户端就出现了

```
login:
```

可以动手了。

有趣的是:

```bash
$ w
USER     TTY      FROM              LOGIN@  IDLE WHAT
scateu   ttyACM0  .....
```

# 无人值守: mgetty

由于我们没有振铃信号，无法出现`RING`字样。

```bash
sudo /usr/sbin/mgetty -r 
tail -f /var/log/mgetty.ttyACM0
```

好吧，由于没有程控电话交换机，没搞定.... 留作习题


# See also

 - 据说用`AT+MS=V32`设置波特率为9600，Skype上也很稳
